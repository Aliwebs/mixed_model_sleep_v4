2025-05-13 00:00:41 - INFO - root - setup_training_logging - Training script logging configured.
2025-05-13 00:00:41 - INFO - __main__ - run_training_pipeline - --- Starting Sleep Model Training Pipeline ---
2025-05-13 00:00:41 - INFO - __main__ - generate_synthetic_data_if_needed - Generating synthetic data (1000 rows, 50 participants) at synthetic_sleep_enhanced_v3.csv...
2025-05-13 00:00:41 - INFO - __main__ - generate_synthetic_data_if_needed - Synthetic data generated and saved to synthetic_sleep_enhanced_v3.csv
2025-05-13 00:00:41 - INFO - SleepQualityModel - load_data - Attempting to load data from synthetic_sleep_enhanced_v3.csv
2025-05-13 00:00:41 - INFO - SleepQualityModel - load_data - Successfully loaded data from synthetic_sleep_enhanced_v3.csv. Shape: (1000, 19)
2025-05-13 00:00:41 - INFO - SleepQualityModel - split_data - Splitting data. Test size: 0.25, Temporal: False, Test days: 7
2025-05-13 00:00:41 - INFO - SleepQualityModel - split_data - Participant-based random split: 732 train (37 users), 268 test (13 users).
2025-05-13 00:00:41 - INFO - SleepQualityModel - fit_scaler - Fitting StandardScaler...
2025-05-13 00:00:41 - INFO - SleepQualityModel - fit_scaler - StandardScaler fitted on features: ['ScreenTime', 'StressLevel', 'DietScore', 'CircadianStability', 'PhysicalActivity', 'CaffeineIntake', 'BedroomNoise', 'BedroomLight', 'EveningAlcohol', 'ExerciseFrequency', 'SocialJetlag', 'MindfulnessPractice', 'AvgHRV', 'DeepSleepProportion', 'StepsToday', 'RestingHR']
2025-05-13 00:00:41 - INFO - SleepQualityModel - preprocess_data - Starting data preprocessing... Is training data: True
2025-05-13 00:00:41 - INFO - SleepQualityModel - preprocess_data - Temporal features (DayOfWeek, DaysSinceStart) created.
2025-05-13 00:00:41 - INFO - SleepQualityModel - preprocess_data - Data transformed using pre-fitted scaler for features: ['ScreenTime', 'StressLevel', 'DietScore', 'CircadianStability', 'PhysicalActivity', 'CaffeineIntake', 'BedroomNoise', 'BedroomLight', 'EveningAlcohol', 'ExerciseFrequency', 'SocialJetlag', 'MindfulnessPractice', 'AvgHRV', 'DeepSleepProportion', 'StepsToday', 'RestingHR']
2025-05-13 00:00:41 - INFO - SleepQualityModel - preprocess_data - Preprocessing completed. Processed data shape: (732, 21)
2025-05-13 00:00:41 - INFO - SleepQualityModel - preprocess_data - Starting data preprocessing... Is training data: False
2025-05-13 00:00:41 - INFO - SleepQualityModel - preprocess_data - Temporal features (DayOfWeek, DaysSinceStart) created.
2025-05-13 00:00:41 - INFO - SleepQualityModel - preprocess_data - Data transformed using pre-fitted scaler for features: ['ScreenTime', 'StressLevel', 'DietScore', 'CircadianStability', 'PhysicalActivity', 'CaffeineIntake', 'BedroomNoise', 'BedroomLight', 'EveningAlcohol', 'ExerciseFrequency', 'SocialJetlag', 'MindfulnessPractice', 'AvgHRV', 'DeepSleepProportion', 'StepsToday', 'RestingHR']
2025-05-13 00:00:41 - INFO - SleepQualityModel - preprocess_data - Preprocessing completed. Processed data shape: (268, 21)
2025-05-13 00:00:41 - INFO - SleepQualityModel - fit_global_models - Fitting global predictive models...
2025-05-13 00:00:41 - INFO - SleepQualityModel - fit_global_models - Stored sample (100 rows) of training data for global explainers.
2025-05-13 00:00:41 - INFO - SleepQualityModel - fit_global_models - Global Mixed effects model fitted successfully.
2025-05-13 00:00:42 - INFO - SleepQualityModel - fit_global_models - Global Random Forest model fitted successfully.
2025-05-13 00:00:42 - INFO - SleepQualityModel - fit_global_models - Global XGBoost model fitted successfully.
2025-05-13 00:00:42 - INFO - __main__ - run_training_pipeline - 
--- Evaluating Global Models on Test Set ---
2025-05-13 00:00:42 - INFO - SleepQualityModel - evaluate_models - Evaluating global models...
2025-05-13 00:00:42 - INFO - SleepQualityModel - evaluate_models - --- Evaluation Summary (global) ---
2025-05-13 00:00:42 - INFO - SleepQualityModel - evaluate_models -   mixed_effects (global fixed): RMSE=1.043, R²=0.122, MAE=0.835
2025-05-13 00:00:42 - INFO - SleepQualityModel - evaluate_models -   random_forest: RMSE=1.079, R²=0.060, MAE=0.856
2025-05-13 00:00:42 - INFO - SleepQualityModel - evaluate_models -   xgboost: RMSE=1.115, R²=-0.003, MAE=0.888
2025-05-13 00:00:42 - INFO - SleepQualityModel - evaluate_models - --- End Evaluation Summary ---
2025-05-13 00:00:42 - INFO - __main__ - run_training_pipeline - Global Model Evaluation Results:
{'mixed_effects (global fixed)': {'mse': 1.0887090772093964, 'rmse': np.float64(1.0434122278416122), 'r2': 0.1221751840678339, 'mae': 0.8350487470881107}, 'random_forest': {'mse': 1.1652503797465437, 'rmse': np.float64(1.079467637192771), 'r2': 0.06046002414365825, 'mae': 0.8560108381764376}, 'xgboost': {'mse': 1.2441651458944771, 'rmse': np.float64(1.1154215104141023), 'r2': -0.0031688566274128416, 'mae': 0.8876476189983424}}
2025-05-13 00:00:42 - INFO - __main__ - run_training_pipeline - 
--- Cross-Validating Global Models on Training Set ---
2025-05-13 00:00:42 - INFO - SleepQualityModel - cross_validate_global_models - Starting 3-fold cross-validation for global models...
2025-05-13 00:00:42 - INFO - SleepQualityModel - cross_validate_global_models - --- CV Fold 1/3 ---
2025-05-13 00:00:42 - INFO - SleepQualityModel - cross_validate_global_models - --- CV Fold 2/3 ---
2025-05-13 00:00:42 - INFO - SleepQualityModel - cross_validate_global_models - --- CV Fold 3/3 ---
2025-05-13 00:00:42 - INFO - SleepQualityModel - cross_validate_global_models - --- Cross-Validation Summary ---
2025-05-13 00:00:42 - INFO - SleepQualityModel - cross_validate_global_models -   random_forest:
2025-05-13 00:00:42 - INFO - SleepQualityModel - cross_validate_global_models -     RMSE: 1.052 ± 0.006
2025-05-13 00:00:42 - INFO - SleepQualityModel - cross_validate_global_models -     R²:   0.012 ± 0.015
2025-05-13 00:00:42 - INFO - SleepQualityModel - cross_validate_global_models -     MAE:  0.841 ± 0.016
2025-05-13 00:00:42 - INFO - SleepQualityModel - cross_validate_global_models -   xgboost:
2025-05-13 00:00:42 - INFO - SleepQualityModel - cross_validate_global_models -     RMSE: 1.113 ± 0.033
2025-05-13 00:00:42 - INFO - SleepQualityModel - cross_validate_global_models -     R²:   -0.106 ± 0.046
2025-05-13 00:00:42 - INFO - SleepQualityModel - cross_validate_global_models -     MAE:  0.880 ± 0.010
2025-05-13 00:00:42 - INFO - SleepQualityModel - cross_validate_global_models - --- End Cross-Validation Summary ---
2025-05-13 00:00:42 - INFO - __main__ - run_training_pipeline - Global Model Cross-Validation Results:
{'random_forest': {'mean_rmse': np.float64(1.0521793153322851), 'std_rmse': np.float64(0.006293057950509872), 'mean_r2': np.float64(0.011683947389392602), 'std_r2': np.float64(0.01498128818488785), 'mean_mae': np.float64(0.8406714855240377), 'std_mae': np.float64(0.016204009408483933)}, 'xgboost': {'mean_rmse': np.float64(1.1132419058156247), 'std_rmse': np.float64(0.03254111930733358), 'mean_r2': np.float64(-0.10628903156730884), 'std_r2': np.float64(0.046310935366324094), 'mean_mae': np.float64(0.8800075103676384), 'std_mae': np.float64(0.010429318375489832)}}
2025-05-13 00:00:42 - INFO - __main__ - run_training_pipeline - 
--- Simulating User-Specific Fine-Tuning ---
2025-05-13 00:00:43 - INFO - SleepQualityModel - fine_tune_model_for_user - Attempting to fine-tune random_forest for user User_0
2025-05-13 00:00:43 - INFO - SleepQualityModel - fine_tune_model_for_user - Successfully fine-tuned and stored model and explainer data for User_0_random_forest
2025-05-13 00:00:43 - INFO - __main__ - run_training_pipeline - No test data found for user User_0 to evaluate fine-tuned model.
2025-05-13 00:00:43 - INFO - SleepQualityModel - fine_tune_model_for_user - Attempting to fine-tune random_forest for user User_1
2025-05-13 00:00:43 - INFO - SleepQualityModel - fine_tune_model_for_user - Successfully fine-tuned and stored model and explainer data for User_1_random_forest
2025-05-13 00:00:43 - INFO - __main__ - run_training_pipeline - No test data found for user User_1 to evaluate fine-tuned model.
2025-05-13 00:00:43 - INFO - __main__ - run_training_pipeline - 
--- Saving Model Bundle to sleep_model_bundle_v2.pkl ---
2025-05-13 00:00:43 - INFO - SleepQualityModel - save_model - Saving model bundle to sleep_model_bundle_v2.pkl...
2025-05-13 00:00:43 - INFO - SleepQualityModel - save_model - Model bundle saved successfully to sleep_model_bundle_v2.pkl
2025-05-13 00:00:43 - INFO - __main__ - run_training_pipeline - --- Sleep Model Training Pipeline Completed Successfully ---
